# dhall-terraform-output

[![standard-readme compliant](https://img.shields.io/badge/readme%20style-standard-brightgreen.svg?style=flat-square)](https://github.com/RichardLitt/standard-readme)

> Takes Terraform output and presents it as a Dhall value with a generated Dhall type

### Limitations
Supports Terraform `string` and `list` output only, producing `Natural`, `Text`, and `List Text` types in the generated output.

## Install

```bash
curl -sL https://raw.githubusercontent.com/coralogix/dhall-terraform-output/v0.1.0/dhall-terraform-output
chmod +x dhall-terraform-output
mv dhall-terraform-output /usr/local/bin/dhall-terraform-output
```

### Dependencies
* [Dhall](https://github.com/dhall-lang/dhall-haskell)
* [jq](https://github.com/stedolan/jq)

## Usage

### Main invocation
`dhall-terraform-output [-?|-h|--help|help] <type_file> <out_file>`
* `-?` `-h` `--help` `help` : Print this help message
* `type_file` : The file location of the Dhall type to be generated. Will not create directories which don't previously exist.
* `out_file` : The file location of the Dhall output record to be generated. Will not create directories which don't previously exist.

### Exit codes
* `0`: Success
* `1`: Dependent tools (jq, dhall) not installed on the path
* `2`: Terraform output an unsupported type

### Example usage
`terraform output -json | dhall-terraform-output ./type.dhall ./output.dhall`

### Example output for example usage
for `terraform output -json`:
  
```json
{
    "aws_vpc_id": {
        "sensitive": false,
        "type": "string",
        "value": "vpc-123abc"
    }
}
```

`./type.dhall`:
  
```dhall
-- Generated by dhall-terraform-output
{ aws_vpc_id : Text } : Type
```

`./output.dhall`:
  
```dhall
-- Generated by dhall-terraform-output
{ aws_vpc_id = "vpc-123abc" }
```

## Maintainers
* [Ari Becker](https://github.com/ari-becker)
* [Oded David](https://github.com/oded-dd)

## Contributing
TBD

## License
[Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0) Â© Coralogix, Inc.
